#!/bin/sh
#
# Appears to have been unused for nearly two years:
#
# bridgedb@ponticum:/srv/bridges.torproject.org$ stat bin/sync-to-yatei
#   File: `bin/sync-to-yatei'
#   Size: 453             Blocks: 8          IO Block: 4096   regular file
# Device: fe20h/65056d    Inode: 131332      Links: 1
# Access: (0755/-rwxr-xr-x)  Uid: ( 1531/bridgedb)   Gid: ( 1531/bridgedb)
# Access: 2014-01-13 01:07:09.946692804 +0000
# Modify: 2012-04-12 11:13:23.598808539 +0000
# Change: 2012-04-12 11:13:23.598808539 +0000
#  Birth: -

set -e
set -u

STORE="/srv/bridges.torproject.org/from-authority-bridge-directories"
LOGDIR="/srv/bridges.torproject.org/log"
cd "$STORE"
rsync \
        -a \
        --exclude from-tonga-latest.tar.gz \
        --remove-source-files \
        . \
        metrics@yatei.torproject.org:/srv/metrics.torproject.org/bridge-directories/ponticum/

cd "$LOGDIR"
rsync \
        -a \
        assignments.log* \
        metrics@yatei.torproject.org:/srv/metrics.torproject.org/bridge-assignments/ponticum/
